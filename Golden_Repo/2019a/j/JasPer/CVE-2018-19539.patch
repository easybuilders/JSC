From 243749e5a6384acdb9f0a59515c0b85dfd62bd5b Mon Sep 17 00:00:00 2001
From: Michael Vetter <jubalh@iodoru.org>
Date: Tue, 12 Mar 2019 17:40:11 +0100
Subject: [PATCH] Check data in jas_image

Regarding CVE-2018-19539.
Fix by Markus Koschany <apo@debian.org>.
From https://gist.github.com/apoleon/7c0f3a0c28437c18fee8a51b1aa16164.
---
 src/libjasper/base/jas_image.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/src/libjasper/base/jas_image.c b/src/libjasper/base/jas_image.c
index e71b86a..6728cad 100644
--- a/src/libjasper/base/jas_image.c
+++ b/src/libjasper/base/jas_image.c
@@ -491,6 +491,10 @@ int jas_image_readcmpt(jas_image_t *image, int cmptno, jas_image_coord_t x,
 	  image, cmptno, JAS_CAST(long, x), JAS_CAST(long, y),
 	  JAS_CAST(long, width), JAS_CAST(long, height), data));
 
+	if(data == NULL) {
+		return -1;
+	}
+
 	if (cmptno < 0 || cmptno >= image->numcmpts_) {
 		return -1;
 	}
