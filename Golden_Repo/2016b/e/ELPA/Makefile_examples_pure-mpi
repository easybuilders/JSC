MPICH_FC  = ifort
MPICH_F77 = ifort 
MPICH_F90 = ifort 
MPIFC = mpif90
CFLAGS   = 
LOADER   = mpif90
LOADOPTS = 
INCLUDE = -I$(EBROOTELPA)/include -I$(EBROOTELPA)/include/elpa-2016.05.003/elpa -I$(EBROOTELPA)/include/elpa-2016.05.003/modules
FCLIBS = -lifcore -lifport
BLAS = -Wl,-Bstatic -Wl,--start-group -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -Wl,--end-group -Wl,-Bdynamic
ELPALIB = -L$(ELPA_LIB) -lelpa
SCALAPACK = -lmkl_scalapack_lp64 -lmkl_blacs_intelmpi_lp64 
LAPACK =
EXAMPLESLIB = -L$(ELPA_LIB) -lelpatest -lelpa_public -lelpa_private

all: test_complex test_complex2 test_complex2_api test_complex2_default test_real test_real2 test_real2_api test_real2_default test_real2_qr test_toeplitz elpa2_print_kernels

test_complex: test_complex.o
	$(LOADER) $(LOADOPTS) -o $@ test_complex.o $(EXAMPLESLIB) $(ELPALIB) $(SCALAPACK) $(LAPACK) $(BLAS) $(FCLIBS)

test_complex2: test_complex2.o
	$(LOADER) $(LOADOPTS) -o $@ test_complex2.o $(EXAMPLESLIB) $(ELPALIB) $(SCALAPACK) $(LAPACK) $(BLAS) $(FCLIBS)

test_complex2_api: test_complex2_api.o
	$(LOADER) $(LOADOPTS) -o $@ test_complex2_api.o $(EXAMPLESLIB) $(ELPA) $(SCALAPACK) $(LAPACK) $(BLAS) $(FCLIBS)

test_complex2_default: test_complex2_default.o
	$(LOADER) $(LOADOPTS) -o $@ test_complex2_default.o $(EXAMPLESLIB) $(ELPALIB) $(SCALAPACK) $(LAPACK) $(BLAS) $(FCLIBS)

test_real: test_real.o
	$(LOADER) $(LOADOPTS) -o $@ test_real.o $(EXAMPLESLIB) $(ELPALIB) $(SCALAPACK) $(LAPACK) $(BLAS) $(FCLIBS)

test_real2: test_real2.o
	$(LOADER) $(LOADOPTS) -o $@ test_real2.o $(EXAMPLESLIB) $(ELPALIB) $(SCALAPACK) $(LAPACK) $(BLAS) $(FCLIBS)

test_real2_api: test_real2_api.o
	$(LOADER) $(LOADOPTS) -o $@ test_real2_api.o $(EXAMPLESLIB) $(ELPALIB) $(SCALAPACK) $(LAPACK) $(BLAS) $(FCLIBS)

test_real2_default: test_real2_default.o
	$(LOADER) $(LOADOPTS) -o $@ test_real2_default.o $(EXAMPLESLIB) $(ELPALIB) $(SCALAPACK) $(LAPACK) $(BLAS) $(FCLIBS)

test_real2_qr: test_real2_qr.o
	$(LOADER) $(LOADOPTS) -o $@ test_real2_qr.o $(EXAMPLESLIB) $(ELPALIB) $(SCALAPACK) $(LAPACK) $(BLAS) $(FCLIBS)

test_toeplitz: test_toeplitz.o
	$(LOADER) $(LOADOPTS) -o $@ test_toeplitz.o $(EXAMPLESLIB) $(ELPALIB) $(SCALAPACK) $(LAPACK) $(BLAS) $(FCLIBS)


elpa2_print_kernels: elpa2_print_kernels.o
	$(LOADER) $(LOADOPTS) -o $@ elpa2_print_kernels.o $(EXAMPLESLIB) $(ELPALIB) $(SCALAPACK) $(LAPACK) $(BLAS) $(FCLIBS)

.SUFFIXES: .F90 .o
.F90.o:
	$(MPIFC) $(INCLUDE) $(CFLAGS) -c $< -o $@
