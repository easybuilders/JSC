# This file is part of JSC's public easybuild repository (https://github.com/easybuilders/jsc)
easyblock = 'PythonBundle'

name = 'jupyter-server'
version = "2.12.5"

homepage = 'https://jupyter.org/'
description = """The Jupyter Server provides the backend (i.e. the core services, APIs, and REST
endpoints) for Jupyter web applications like Jupyter notebook, JupyterLab, and
Voila."""

toolchain = {'name': 'GCCcore', 'version': '12.3.0'}

builddependencies = [
    ('binutils', '2.40'),
    ('maturin', '1.4.0', '-Rust-1.70.0'),
]
dependencies = [
    ('Python', '3.11.3'),
    ('IPython', '8.14.0'),
    ('PyYAML', '6.0'),
    ('PyZMQ', '25.1.2'),
    ('tornado', '6.3.2'),
]

sanity_pip_check = True
use_pip = True

# WARNING: the versions of ipywidgets, widgetsnbextension and jupyterlab_widgets are tied between them
# use the versions published in a single release commit instead of blindly pushing to last available version,
# see for instance https://github.com/jupyter-widgets/ipywidgets/commit/4d93d8eff1bd88faf1e8906c50a80718fd57f867

exts_list = [
    ('hatch_nodejs_version', '0.3.2', {
        'checksums': ['8a7828d817b71e50bbbbb01c9bfc0b329657b7900c56846489b9c958de15b54c'],
    }),
    ('hatch_jupyter_builder', '0.8.3', {
        'checksums': ['0dbd14a8aef6636764f88a8fd1fcc9a91921e5c50356e6aab251782f264ae960'],
    }),
    ('websocket-client', '1.7.0', {
        'modulename': 'websocket',
        'checksums': ['10e511ea3a8c744631d3bd77e61eb17ed09304c413ad42cf6ddfa4c7787e8fe6'],
    }),
    ('terminado', '0.18.0', {
        'checksums': ['1ea08a89b835dd1b8c0c900d92848147cef2537243361b2e3f4dc15df9b6fded'],
    }),
    ('Send2Trash', '1.8.2', {
        'checksums': ['c132d59fa44b9ca2b1699af5c86f57ce9f4c5eb56629d5d55fbb7a35f84e2312'],
    }),
    ('prometheus_client', '0.20.0', {
        'checksums': ['287629d00b147a32dcb2be0b9df905da599b2d82f80377083ec8463309a4bb89'],
    }),
    ('overrides', '7.7.0', {
        'checksums': ['55158fa3d93b98cc75299b1e67078ad9003ca27945c76162c1c0766d6f91820a'],
    }),
    ('jupyter_core', '5.7.1', {
        'checksums': ['de61a9d7fc71240f688b2fb5ab659fbb56979458dc66a71decd098e03c79e218'],
    }),
    ('fastjsonschema', '2.19.1', {
        'checksums': ['e3126a94bdc4623d3de4485f8d468a12f02a67921315ddc87836d6e456dc789d'],
    }),
    ('tinycss2', '1.2.1', {
        'checksums': ['8cff3a8f066c2ec677c06dbc7b45619804a6938478d9d73c284b29d14ecb0627'],
    }),
    ('pandocfilters', '1.5.1', {
        'checksums': ['002b4a555ee4ebc03f8b66307e287fa492e4a77b4ea14d3f934328297bb4939e'],
    }),
    ('mistune', '3.0.1', {
        'checksums': ['e912116c13aa0944f9dc530db38eb88f6a77087ab128f49f84a48f4c05ea163c'],
    }),
    ('jupyterlab_pygments', '0.3.0', {
        'checksums': ['721aca4d9029252b11cfa9d185e5b5af4d54772bb8072f9b7036f4170054d35d'],
    }),
    ('defusedxml', '0.7.1', {
        'checksums': ['1bb3032db185915b62d7c6209c5a8792be6a32ab2fedacc84e01b52c51aa3e69'],
    }),
    ('bleach', '6.1.0', {
        'checksums': ['0a31f1837963c41d46bbf1331b8778e1308ea0791db03cc4e7357b97cf42a8fe'],
    }),
    ('nbformat', '5.9.2', {
        'checksums': ['5f98b5ba1997dff175e77e0c17d5c10a96eaed2cbd1de3533d1fc35d5e111192'],
    }),
    ('nbclient', '0.9.0', {
        'checksums': ['4b28c207877cf33ef3a9838cdc7a54c5ceff981194a82eac59d558f05487295e'],
    }),
    ('jupyter_client', '8.6.0', {
        'checksums': ['0642244bb83b4764ae60d07e010e15f0e2d275ec4e918a8f7b80fbbef3ca60c7'],
    }),
    ('nbconvert', '7.16.1', {
        'checksums': ['e79e6a074f49ba3ed29428ed86487bf51509d9aab613bd8522ac08f6d28fd7fd'],
    }),
    ('jupyter_server_terminals', '0.5.2', {
        'checksums': ['396b5ccc0881e550bf0ee7012c6ef1b53edbde69e67cab1d56e89711b46052e8'],
    }),
    ('rfc3986_validator', '0.1.1', {
        'checksums': ['3d44bde7921b3b9ec3ae4e3adca370438eccebc676456449b145d533b240d055'],
    }),
    ('rfc3339_validator', '0.1.4', {
        'checksums': ['138a2abdf93304ad60530167e51d2dfb9549521a836871b88d7f4695d0022f6b'],
    }),
    ('rpds_py', '0.18.0', {
        'modulename': 'rpds',
        'checksums': ['42821446ee7a76f5d9f71f9e33a4fb2ffd724bb3e7f93386150b61a43115788d'],
    }),
    ('referencing', '0.33.0', {
        'checksums': ['c775fedf74bc0f9189c2a3be1c12fd03e8c23f4d371dce795df44e06c5b412f7'],
    }),
    ('python-json-logger', '2.0.7', {
        'modulename': 'pythonjsonlogger',
        'checksums': ['23e7ec02d34237c5aa1e29a070193a4ea87583bb4e7f8fd06d3de8264c4b2e1c'],
    }),
    ('jsonschema_specifications', '2023.12.1', {
        'checksums': ['48a76787b3e70f5ed53f1160d2b81f586e4ca6d1548c5de7085d1682674764cc'],
    }),
    ('jsonschema', '4.21.1', {
        'checksums': ['85727c00279f5fa6bedbe6238d2aa6403bedd8b4864ab11207d07df3cc1b2ee5'],
    }),
    ('jupyter_events', '0.9.0', {
        'checksums': ['81ad2e4bc710881ec274d31c6c50669d71bbaa5dd9d01e600b56faa85700d399'],
    }),
    ('argon2-cffi-bindings', '21.2.0', {
        'modulename': '_argon2_cffi_bindings',
        'checksums': ['bb89ceffa6c791807d1305ceb77dbfacc5aa499891d2c55661c6459651fc39e3'],
    }),
    ('argon2_cffi', '23.1.0', {
        'modulename': 'argon2',
        'checksums': ['879c3e79a2729ce768ebb7d36d4609e3a78a4ca2ec3a9f12286ca057e3d0db08'],
    }),
    ('sniffio', '1.3.1', {
        'checksums': ['f4324edc670a0f49750a81b895f35c3adb843cca46f0530f79fc1babb23789dc'],
    }),
    ('anyio', '4.3.0', {
        'checksums': ['f75253795a87df48568485fd18cdd2a3fa5c4f7c5be8e5e36637733fce06fed6'],
    }),
    ('jupyter_server', version, {
        'checksums': ['0edb626c94baa22809be1323f9770cf1c00a952b17097592e40d03e6a3951689'],
    }),
    ('deprecation', '2.1.0', {
        'checksums': ['72b3bde64e5d778694b0cf68178aed03d15e15477116add3fb773e581f9518ff'],
    }),
    ('jupyter_packaging', '0.12.3', {
        'checksums': ['9d9b2b63b97ffd67a8bc5391c32a421bc415b264a32c99e4d8d8dd31daae9cf4'],
    }),
    ('jupyterlab_widgets', '3.0.10', {
        'checksums': ['04f2ac04976727e4f9d0fa91cdc2f1ab860f965e504c29dbd6a65c882c9d04c0'],
    }),
    ('widgetsnbextension', '4.0.10', {
        'checksums': ['64196c5ff3b9a9183a8e699a4227fb0b7002f252c814098e66c4d1cd0644688f'],
    }),
    ('comm', '0.2.1', {
        'checksums': ['0bc91edae1344d39d3661dcbc36937181fdaddb304790458f8b044dbc064b89a'],
    }),
    ('ipywidgets', '8.1.2', {
        'checksums': ['d0b9b41e49bae926a866e613a39b0f0097745d2b9f1f3dd406641b4a57ec42c9'],
    }),
    ('notebook_shim', '0.2.4', {
        'checksums': ['b4b2cfa1b65d98307ca24361f5b30fe785b53c3fd07b7a47e89acb5e6ac638cb'],
    }),
    ('nest_asyncio', '1.6.0', {
        'checksums': ['6f172d5449aca15afd6c646851f4e31e02c598d553a667e38cafa997cfec55fe'],
    }),
    ('ipykernel', '6.29.1', {
        'checksums': ['1547352b32da95a2761011a8dac2af930c26a0703dfa07690d16b7d74dac0ba1'],
    }),
    ('ipython_genutils', '0.2.0', {
        'checksums': ['eb2e116e75ecef9d4d228fdc66af54269afa26ab4463042e33785b887c628ba8'],
    }),
    ('debugpy', '1.8.1', {
        'source_tmpl': '%(name)s-%(version)s-py2.py3-none-any.whl',
        'checksums': ['28acbe2241222b87e255260c76741e1fbf04fdc3b6d094fcf57b6c6f75ce1242'],
    }),
]

sanity_check_paths = {
    'files': ['bin/jupyter'],
    'dirs': ['share/jupyter', 'etc/jupyter'],
}

sanity_check_commands = ['jupyter --help']

modextrapaths = {
    'JUPYTER_CONFIG_PATH': 'etc/jupyter',
    'JUPYTER_PATH': 'share/jupyter',
}

moduleclass = 'tools'
